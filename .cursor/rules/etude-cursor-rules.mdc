---
alwaysApply: true
---

# ðŸ“Œ Project Rules - Etude LMS

## Tech Stack

- Frontend: Next.js (App Router), React, TypeScript
- Styling: Tailwind CSS, Shadcn UI, Lucide React, Framer Motion
- State Management: Zustand, TanStack Query, React Hook Form + Zod
- Backend: Supabase (DB, Auth, RLS)

## Core Features

- **Authentication & Roles**: Supabase Auth + RLS, roles = student/teacher/admin, approval state management
- **Dashboard**: user info, announcements, exam schedules, learning progress
- **AP Exams**: subjects, chapters, MCQ & FRQ, timer, answer saving
- **SAT Exams**: Reading/Writing/Math, MCQ & SPR, timer, answer saving
- **Results & Analysis**: score summary, wrong answers tracking (`user_ap_wrong_answer`, `user_sat_wrong_answer`), performance charts
- **Announcements & Schedule**: `schedule`, `announcement` management

## Database ERD Summary

- **Users & Roles**: `users`, `profile`, `service`, `user_service`
- **AP**: `ap`, `chapter`, `ap_exam`, `ap_exam_question`, `ap_exam_choice`, `user_ap_result`, `user_ap_wrong_answer`
- **SAT**: `sat`, `sat_test_question`, `sat_test_mcq`, `sat_test_spr`, `user_sat_result`, `user_sat_wrong_answer`
- **Common**: `schedule`, `announcement`
- **Learning Materials**: `mcq`, `frq`, `ap_chapter_video`, `ap_exam_video`

## Page Flow

### Authentication Flow

1. **Landing Page** (`/`) â†’ Login/Signup selection
2. **Auth Pages** (`/auth/login`, `/auth/signup`) â†’ Authentication processing
3. **Auth Callback** (`/auth/callback`) â†’ Supabase authentication callback
4. **Pending Approval** (`/auth/pending-approval`) â†’ Pending approval status
5. **Service Expired** (`/auth/service-expired`) â†’ Service expiration status

### Dashboard Flow

1. **Dashboard Root** (`/dashboard`) â†’ Auto-redirect to `/dashboard/overview`
2. **Overview** (`/dashboard/overview`) â†’ Personal info, schedule, announcements, subject progress
3. **AP Courses** (`/dashboard/ap-courses`) â†’ AP subject-specific chapters and exams
4. **SAT Exams** (`/dashboard/sat-exams`) â†’ SAT mock exam list

### AP Exam Flow

1. **AP Courses** (`/dashboard/ap-courses`) â†’ AP subject selection
2. **AP Exam Instruction** (`/dashboard/ap-courses/ap-exam-instruction`) â†’ Exam instructions and preparation
3. **AP Exam** (`/ap-exam`) â†’ Actual AP exam (MCQ & FRQ)
4. **AP Results** (`/ap-results`) â†’ AP exam results and wrong answer analysis

### SAT Exam Flow

1. **SAT Exams** (`/dashboard/sat-exams`) â†’ SAT mock exam selection
2. **SAT Section Select** (`/sat-section-select`) â†’ Section progress check and selection
3. **SAT Exam** (`/exam`) â†’ Actual SAT exam (Reading/Writing/Math)
4. **SAT Results** (`/sat-results`) â†’ SAT exam results and wrong answer analysis
5. **SAT Detailed Results** (`/sat-detailed-results`) â†’ Detailed score analysis

### Navigation Patterns

- **URL Parameters**: `?subject=`, `?examId=`, `?subjectId=` for state passing
- **Auto-redirect**: Automatic page navigation based on authentication status
- **Back Navigation**: Return to previous page functionality in exam pages

## Design System

- **Colors**: Primary Blue (#0091B3), Background Beige (#faf9f7), Card White (#ffffff), dark mode supported
- **Principles**: Border Radius 12px, hover shadows, Shadcn UI components, Tailwind utilities, ARIA accessibility
